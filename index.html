<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>법령 문서</title>
</head>
<body>
  <h1 id="title">대한민국 헌법</h1>

  <textarea id="content" rows="10" cols="80">
제1조 (목적) 이 헌법은...
  </textarea>

  <br><br>

  <button onclick="save()">수정 내용 저장</button>

 <script>
  const SUPABASE_URL = "여기에 Project URL 넣기";
  const SUPABASE_KEY = "여기에 anon public key 넣기";

  const supabase = window.supabase.createClient(
    SUPABASE_URL,
    SUPABASE_KEY
  );

  async function save() {
    const content = document.getElementById("content").value;

    // 가장 최신 버전 가져오기
    const { data: latest } = await supabase
      .from("documents")
      .select("version")
      .order("version", { ascending: false })
      .limit(1);

    const nextVersion = latest && latest.length > 0
      ? latest[0].version + 1
      : 1;

    // 새 버전 저장
    await supabase.from("documents").insert({
      title: "대한민국 헌법",
      content: content,
      version: nextVersion,
      created_by: "admin"
    });

    alert("새 버전이 저장되었습니다! (version " + nextVersion + ")");
  }
</script>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</body>
</html>

